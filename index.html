<html>

 <head>
  <title></title>
  <script src="customSetting.js"></script>
  <script src="src/jquery-3.2.1.min.js"></script>
  <script>
    $.noConflict();
    var jqry = jQuery;

    jqry(document).ajaxSuccess(function(){
         jqry('#_processing_div_').remove();
    }).ajaxSend(function(){
         jqry('#_processing_div_').remove();
         var _prcessing_img_ = jqry('<table>').css('margin','auto').append(jqry('<tr>').append('<td>').append(jqry('<img></img>').attr('src','img/processing.gif').attr('width','80')));
         var _processing_ = jqry('<div>').attr('id','_processing_div_').append(_prcessing_img_);
         jqry(document.body).append(_processing_);           
    });
    
    var remove_divAll = function(){
      jqry('#_devices_reg_div_').remove();
      jqry('#_adminauth_div_').remove();
      jqry('#_processing_div_').remove();
      jqry('#_regDeviceList_').remove();
      jqry('#_ajax_return_result_div_').remove();
      jqry('#_select_clusterGroup_').remove();
      jqry('#_devicesInfoUpdate_subMenu_div_').remove();
      jqry('#_deviceUpdated_infoView_div_').remove();
      jqry('#_deviceUpdated_infoView_table_').remove();
    };

    function _addLine_forText_(_menu_table_, text_strings){
      var _line_ = jqry('<tr>');
      jqry.each(text_strings, function(index, element){
        var _element_ = jqry('<th>');
        _element_.html(element);
        _element_.css('color','grey').css('font-size','10');
        _line_.append(_element_);
      });
      _menu_table_.append(_line_);
    };

    function _addLine_forObject_(_table_, object_array){
      var _line_ = jqry('<tr>');
      jqry.each(object_array, function(index, element){
         _line_.append(jqry('<td>').append(element));
      });
      _table_.append(_line_);
    };

    var _ajaxSuccess_multiLine_printing_ = function(_dataFromajax_, _divIdName_){
       var _getFrom_ajax_ = JSON.parse(_dataFromajax_);
       var _ajax_return_result_div_ = jqry('<div>').attr('id',_divIdName_).attr('align','center');
       jqry.each(_getFrom_ajax_, function(index, element){
           _ajax_return_result_div_.append(jqry('<div>').html(element.process_msg).css('font-size','11').css('color','red'));
       });
       jqry(document.body).append(_ajax_return_result_div_);
    }

    function _login_auth_start_(_afterLogin_){
      var _hidden_auth_password_ = jqry(document.body).find('#_auth_password_')[0];
      if (_hidden_auth_password_){
        var _hiddenAuthpassword_ = jqry('#_auth_password_').val();
        _afterLogin_();
      }else{
        var _adminauth_div_ = jqry('<div>').attr('id','_adminauth_div_');
        jqry(document.body).append(_adminauth_div_);
        var _adminauth_table_ = jqry('<table>').css('margin','auto');
        text_strings = new Array('admin password', '');
        _addLine_forText_(_adminauth_table_, text_strings);
        var _adminauth_input_ = jqry('<input>').attr('type','password').attr('id','_adminauth_input_');
        var _adminauth_button_ = jqry('<button>').attr('id','_adminauth_button_').html('admin login');
        var _line_element_ = new Array(_adminauth_input_, _adminauth_button_);
        _addLine_forObject_(_adminauth_table_, _line_element_);
        _adminauth_div_.append(_adminauth_table_);
        jqry('#_adminauth_button_').on('click',function(event){
            jqry('#_auth_password_').remove();
            jqry('#_ajax_return_result_div_').remove();
            jqry.ajax({
                 type:"POST",
                 url:ajax_api_server.concat('juniper/confirmauth/'),
                 data:JSON.stringify({
                    auth_password:jqry('#_adminauth_input_').val(),
                 }),
                 success:function(data){
                    var _getFrom_ajax_= JSON.parse(data);
                    //
                    if (_getFrom_ajax_.process_status.match('error')){
                      var _ajax_return_result_div_ = jqry('<div>').attr('id','_ajax_return_result_div_').attr('align','center');
                      _ajax_return_result_div_.append(jqry('<h5>').html(_getFrom_ajax_.process_msg).css('color','red'));             
                      jqry(document.body).append(_ajax_return_result_div_);
                    }else{
                      var _getAuthpassword_ = jqry('<input>').attr('id','_auth_password_').attr('type','hidden').attr('value',_getFrom_ajax_.items[0].auth_password.trim());
                      jqry(document.body).append(_getAuthpassword_);
                      remove_divAll();
                      _afterLogin_();
                    } 
                    //
                 }
            });
            event.preventDefault()
            event.stopPropagation()
            return false 
        });
      }
    };

    var _addSelect_ = function (_array_, _select_id_){
       var _select_ = jqry('<select>').attr('id',_select_id_);
       if (_array_.length != 0){
         jqry.each(_array_, function(index, element){
            _select_.append(jqry('<option>').attr('value',element).html(element));
         });
       }
       _select_.append(jqry('<option>').attr('value','none').html('none'));
       return _select_
    };

    //
    function _addImg_(_filename_){
       var _filestring_ = String(_filename_);
       var _fname_= _filestring_.split('/');
       var _id_ = _fname_[1].split('.');
       var _regImg_ = jqry('<img>');
       _regImg_.attr('src',_filename_);
       _regImg_.attr('id',_id_[0]);
       _regImg_.attr('width','70');
       _regImg_.attr('height','70');
       return _regImg_
    };

    function _addLine_forImg_(_menu_table_, img_filenames){
      var _line_ = jqry('<tr>');
      jqry.each(img_filenames, function(index, element){
        var _element_ = jqry('<td>');
        _element_.append(_addImg_(element));
        _line_.append(_element_); 
      });
      _menu_table_.append(_line_);
    }
    //
     
    ////////////////////////////////// menu function ///////////////////////////////////////
    jqry(document).ready(function(){
      var menu_function = function (){

         remove_divAll();
         var _menu_div_ = jqry('<div>');
         _menu_div_.attr('id','_menu_div_');
         var _menu_table_ = jqry('<table>').css('margin','auto'); 
         _menu_table_.attr('id','_menu_table_');
         // add line
         img_filenames = new Array('img/register_image.png', 'img/group_image.png', 'img/firewallUpdate.png', 'img/book_image.jpeg', 'img/list_image.jpeg', 'img/search_image.png');
         _addLine_forImg_(_menu_table_, img_filenames);
         text_strings = new Array('devices register<br>for admin', 'grouping<br>devices', 'registered devices<br>update', 'routing update<br>for admin', 'policies<br>for admin', 'search<br>for users');
         _addLine_forText_(_menu_table_, text_strings);
         jqry(_menu_div_).append(_menu_table_);
         jqry(document.body).append(_menu_div_);
      };
      jqry('#_auth_password_').remove(); 
      menu_function();
    });

    jqry(document).ready(function(){
      ////////////////////////////////// register button click ///////////////////////////////////////
      jqry('#register_image').on('click',function(event){
         remove_divAll();
         //
         function _register_inputForm_(){
           ///////
           var _devices_reg_div_ = jqry('<div>').attr('id','_devices_reg_div_');
           jqry(document.body).append(_devices_reg_div_);
           jqry('#_regInfoList_').remove();
           var _regInfoList_ = jqry('<div>').attr('id','_regInfoList_');
           jqry(document.body).append(_regInfoList_);
           ///////
           jqry('#_regInfoList_').on('click', 'button', function(event){
                var _splited_ = jqry(this).val().split('@');
                jqry('#_ajax_return_result_div_').remove();
                jqry.ajax({
                   type:"DELETE",
                   url:ajax_api_server.concat('juniper/devicelist/register/'),
                   data:JSON.stringify({
                       items:[{
                          apiaccessip:_splited_[0],
                          hostname:_splited_[1],
                          location:_splited_[2],
                          model:_splited_[3],
                          version:_splited_[4]
                       }],
                       auth_key:jqry('#_auth_password_').val()
                   }),
                   success:function(data){
                       _ajaxSuccess_multiLine_printing_(data, '_ajax_return_result_div_');
                       _regDeviceList_ajax_(_regInfoList_);
                   }
                });
                event.preventDefault()
                event.stopPropagation()
                return false
           }); 
           ///////
           var _regDeviceList_ajax_ = function(_regInfoList_){
              jqry('#_regDeviceList_').remove();
              jqry.ajax({
                 type:"GET",
                 url:ajax_api_server.concat('juniper/devicelist/register/'),
                 success:function(data){
                   var _getFrom_ajax_ = JSON.parse(data);
                   var _getFromArray_ = _getFrom_ajax_.items;                    
                   if (_getFromArray_.length){
                     var _regDeviceList_ = jqry('<table>').css('margin','auto').attr('id','_regDeviceList_');
                     jqry.each(_getFromArray_, function(index, element){
                        var _line_ = jqry('<tr>');
                        _line_.append(jqry('<th>').html(element.apiaccessip).css('color','black').css('font-size','12'));
                        _line_.append(jqry('<th>').html(element.hostname).css('color','red').css('font-size','12'));
                        _line_.append(jqry('<th>').html(element.location).css('color','black').css('font-size','12'));
                        _line_.append(jqry('<th>').html(element.model).css('color','grey').css('font-size','12'));
                        _line_.append(jqry('<th>').html(element.version).css('color','grey').css('font-size','12'));
                        var _element_valuesArray_ = new Array(element.apiaccessip, element.hostname, element.location, element.model, element.version);
                        _line_.append(jqry('<th>').append(jqry('<button>').attr('value',_element_valuesArray_.join('@')).html('Remove').css('color','red').css('font-size','8')));
                        _regDeviceList_.append(_line_);
                     });
                     _regInfoList_.append(_regDeviceList_); 
                   };
                 }
              });
           };
           ///////
           jqry('#_devices_reg_div_').on('click', '#_regButton_', function(event){
                var ip_pattern = new RegExp("^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$");
                var _regIp_ = jqry('#_ipAddr_regi_').val();
                jqry('#_ajax_return_result_div_').remove();
                if (! ip_pattern.test(_regIp_)){
                  var _ajax_return_result_div_ = jqry('<div>').attr('id','_ajax_return_result_div_').attr('align','center');
                  _ajax_return_result_div_.append(jqry('<h5>').html('without subnet, IP only').css('color','red'));             
                  jqry(document.body).append(_ajax_return_result_div_);
                }else{
                  jqry.ajax({
                     type:"POST",
                     url:ajax_api_server.concat('juniper/devicelist/register/'),
                     data:JSON.stringify({
                        items:[{
                           apiaccessip:jqry('#_ipAddr_regi_').val(),
                           location:jqry('#_idc_location_ > option:selected')[0].value
                        }],
                        auth_key:jqry('#_auth_password_').val()
                     }),
                     success:function(data){
                        _ajaxSuccess_multiLine_printing_(data, '_ajax_return_result_div_');
                        _regDeviceList_ajax_(_regInfoList_);
                     } 
                  });
                }
                event.preventDefault()
                event.stopPropagation()
                return false
           });
           var _devices_reg_table_ = jqry('<table>').css('margin','auto').attr('id','_devices_reg_table_');
           text_strings = new Array('IP address<br>to register', 'Location', '');
           _addLine_forText_(_devices_reg_table_, text_strings);
           var _regIp_ = jqry('<input>').attr('type','text').attr('id','_ipAddr_regi_');
           var _idcLocation_ = new Array('ilsan', 'boramae', 'commerce');
           var _regIdc_ = _addSelect_(_idcLocation_, '_idc_location_');
           var _regButton_ = jqry('<button>').attr('id','_regButton_').html('Register');
           var _line_element_ = new Array(_regIp_, _regIdc_, _regButton_);
           _addLine_forObject_(_devices_reg_table_, _line_element_);
           _devices_reg_div_.append(_devices_reg_table_);
           //
           _regDeviceList_ajax_(_regInfoList_);
         };
         _login_auth_start_(_register_inputForm_);
         event.preventDefault()
         event.stopPropagation()
         return false
      });
      ////////////////////////////////// register button click ///////////////////////////////////////
      jqry('#group_image').on('click',function(event){
         remove_divAll();

         function _selectOptoin_create_(_ajaxArray_, _selectObject_){
           jqry.each(_ajaxArray_, function(index, element){
              if (element.clusterStatus.match('none')){
                _selectObject_.append(jqry('<option>').attr('value',element.hostname).html(element.hostname));
              }
           }); 
         };

         function _clusterStatusInfo_(_select_clusterGroup_){
           jqry('#_clusterGroupList_table_').remove();
           jqry.ajax({
             type:"GET",
             url:ajax_api_server.concat('juniper/devicelist/clustering/'),
             success:function(data){
                var _getFrom_ajax_ = JSON.parse(data);
                var _ajaxArray_ = _getFrom_ajax_.items;
                if (_ajaxArray_.length){
                  var _clusterGroupList_table_ = jqry('<table>').attr('id','_clusterGroupList_table_');
                  jqry.each(_ajaxArray_, function(index, element){
                     if (! element.clusterStatus.match('none')){
                       var _line_ = jqry('<tr>');
                       _line_.append(jqry('<th>').html(element.hostname).css('color','red').css('font-size','12'));
                       _line_.append(jqry('<th>').html(element.hahostname).css('color','grey').css('font-size','12'));
                       var _element_valuesArray_ = new Array(element.hostname, element.hahostname);
                       _line_.append(jqry('<th>').append(jqry('<button>').attr('id','_UncluseringButton_').attr('value',_element_valuesArray_.join('@')).html('UnClustering').css('color','red').css('font-size','8')));
                       _clusterGroupList_table_.append(_line_);                  
                     };
                  });
                  _select_clusterGroup_.append(_clusterGroupList_table_);
                } 
             }
           }); 
         }
         //
         function _createSelectOption_forClustering_(_select_clusterGroup_){
           jqry('#_clusterGroup_table_').remove();
           jqry.ajax({
             type:"GET",
             url:ajax_api_server.concat('juniper/devicelist/clustering/'),
             success:function(data){
                var _getFrom_ajax_ = JSON.parse(data);
                var _ajaxArray_ = _getFrom_ajax_.items;
                var _notClustered_array_ = new Array();
                jqry.each(_ajaxArray_, function(index, element){
                  if (element.clusterStatus.match('none')){
                    _notClustered_array_.push(element);
                  }
                });
                if (_notClustered_array_.length){
                  var _clusterGroup_table_ = jqry('<table>').attr('id','_clusterGroup_table_');
                  var _firstClusterName_ = jqry('<select>').attr('id','_firstClusterName_');
                  _selectOptoin_create_(_ajaxArray_, _firstClusterName_)
                  var _secondClusterName_ = jqry('<select>').attr('id','_secondClusterName_');
                  _selectOptoin_create_(_ajaxArray_, _secondClusterName_)
                  var _cluseringButton_ = jqry('<button>').attr('id','_cluseringButton_').html('clustering').css('color','green').css('font-size','12')
                  var _line_element_ = new Array(_firstClusterName_, _secondClusterName_, _cluseringButton_);
                  _addLine_forObject_(_clusterGroup_table_, _line_element_);                   
                  _select_clusterGroup_.append(_clusterGroup_table_);
                };
             }
           });
         };
         //
         function _clusterInfoList_(){
           var _select_clusterGroup_ = jqry('<div>').attr('id','_select_clusterGroup_').attr('align','center');
           jqry(document.body).append(_select_clusterGroup_);
           //
           jqry('#_select_clusterGroup_').on('click', '#_cluseringButton_', function(event){
              jqry('#_ajax_return_result_div_').remove();
              var _firstSelected_ = jqry('#_firstClusterName_ > option:selected').val();
              var _secondSelected_ = jqry('#_secondClusterName_> option:selected').val();
              if (_firstSelected_.match(_secondSelected_) || _secondSelected_.match(_firstSelected_)){
                var _ajax_return_result_div_ = jqry('<div>').attr('id','_ajax_return_result_div_').attr('align','center');
                _ajax_return_result_div_.append(jqry('<h5>').html('same devices chosen').css('color','red'));
                jqry(document.body).append(_ajax_return_result_div_);                        
              }else{
                jqry.ajax({
                   type:"POST",
                   data:JSON.stringify({
                       items:[{
                          hostname:_firstSelected_,
                          hahostname:_secondSelected_
                       }],
                       auth_key:jqry('#_auth_password_').val()
                   }), 
                   url:ajax_api_server.concat('juniper/devicelist/clustering/'),
                   success:function(data){
                     _ajaxSuccess_multiLine_printing_(data, '_ajax_return_result_div_');
                     _createSelectOption_forClustering_(_select_clusterGroup_);
                     _clusterStatusInfo_(_select_clusterGroup_);
                   }
                });
              }
              event.preventDefault()
              event.stopPropagation()
              return false
           }); 
           //
           jqry('#_select_clusterGroup_').on('click', '#_UncluseringButton_', function(event){
              jqry('#_ajax_return_result_div_').remove();
              var _unclusertingButton_array_ = jqry('#_UncluseringButton_').val().split('@');
              jqry.ajax({
                 type:"DELETE",
                 url:ajax_api_server.concat('juniper/devicelist/clustering/'),
                 data:JSON.stringify({
                     items:[{
                        hostname:_unclusertingButton_array_[0],
                        hahostname:_unclusertingButton_array_[1]
                     }],
                     auth_key:jqry('#_auth_password_').val()
                 }),
                 success:function(data){
                     _ajaxSuccess_multiLine_printing_(data, '_ajax_return_result_div_');
                     _createSelectOption_forClustering_(_select_clusterGroup_);
                     _clusterStatusInfo_(_select_clusterGroup_);
                 }
              });
              event.preventDefault()
              event.stopPropagation()
              return false
           });
           //
           _createSelectOption_forClustering_(_select_clusterGroup_)
           _clusterStatusInfo_(_select_clusterGroup_);
         };
         _login_auth_start_(_clusterInfoList_);
         event.preventDefault()
         event.stopPropagation()
         return false
      });
      ////////////////////////////////// register button click ///////////////////////////////////////
      jqry('#firewallUpdate').on('click',function(event){

         function _deviceUpdated_infoView_(_deviceUpdated_infoView_div_){
              jqry('#_deviceUpdated_infoView_select_').remove();
              jqry.ajax({
                 type:"GET",
                 url:ajax_api_server.concat('juniper/devicelist/'),
                 success:function(data){
                     var _getFrom_ajax_ = JSON.parse(data);
                     var _getFrom_ajax_array_ = _getFrom_ajax_.items;
                     var _hostnameList_ = new Array();
                     var _deviceUpdated_infoView_select_= jqry('<select>').css('margin','auto').attr('id','_deviceUpdated_infoView_select_');
                     jqry.each(_getFrom_ajax_array_, function(index, element){
                        if (_hostnameList_.indexOf(element.hostname) == -1){
                          _deviceUpdated_infoView_select_.append(jqry('<option>').attr('value',element.hostname).html(element.hostname));
                          _hostnameList_.push(element.hostname);
                        }
                     _deviceUpdated_infoView_div_.append(_deviceUpdated_infoView_select_);
                     });
                 }
              });              
         };

         function _devicesInfoUpdate_(){
              var _devicesInfoUpdate_subMenu_div_ = jqry('<div>').attr('id','_devicesInfoUpdate_subMenu_div_').attr('align','center');
              jqry(document.body).append(_devicesInfoUpdate_subMenu_div_);
              var _devicesInfoUpdate_subMenu_table_ = jqry('<table>').css('margin','auto').attr('id','_devicesInfoUpdate_subMenu_table_');
              //
              var _deviceUpdated_infoView_div_ = jqry('<div>').attr('id','_deviceUpdated_infoView_div_').attr('align','center');
              jqry(document.body).append(_deviceUpdated_infoView_div_);
              //
              function _callAjax_zoneList_(_thisObj_value_){
                 jqry('#_ajax_return_result_div_').remove();
                 jqry('#_deviceUpdated_infoView_table_').remove();
                 jqry.ajax({
                    type:"GET",
                    url:ajax_api_server.concat('juniper/devicelist/'),
                    success:function(data){
                         var _getFrom_ajax_ = JSON.parse(data);
                         var _getFrom_ajax_array_ = _getFrom_ajax_.items;
                         var _deviceUpdated_infoView_table_ = jqry('<table>').css('margin','auto').attr('id','_deviceUpdated_infoView_table_');
                         _deviceUpdated_infoView_div_.append(_deviceUpdated_infoView_table_);
                         jqry.each(_getFrom_ajax_array_, function(index, element){
                            if (_thisObj_value_.match(element.hostname)){
                              _tableTrObj_ = jqry('<tr>');
                              _tableTrObj_.append(jqry('<th>').css('font-size','11').html(element.hostname).css('color','grey'));
                              _tableTrObj_.append(jqry('<th>').css('font-size','11').html(element.from_zone).css('color','green'));
                              _tableTrObj_.append(jqry('<th>').css('font-size','11').html(element.to_zone).css('color','green')); 
                              var _button_value_string_ = String(element.hostname) + String('#') + String(element.from_zone) + String('#') + String(element.to_zone);
                              if (element.zoneValidation.match('^enable$')){
                                _button_value_string_ = _button_value_string_.concat('#enable#disable');
                                _tableTrObj_.append(jqry('<th>').append(jqry('<button>').attr('value',_button_value_string_).html('enable').css('color','blue').css('font-size','8')));
                              }else{
                                _button_value_string_ = _button_value_string_.concat('#disable#enable');
                                _tableTrObj_.append(jqry('<th>').append(jqry('<button>').attr('value',_button_value_string_).html('disable').css('color','red').css('font-size','8')));
                              };
                              _deviceUpdated_infoView_table_.append(_tableTrObj_);
                            };
                         });
                    }   
                 });
              };
              //
              jqry('#_deviceUpdated_infoView_div_').on('change','#_deviceUpdated_infoView_select_',function(event){
                 var _thisObj_value_ = jqry(this).val();
                 _callAjax_zoneList_(_thisObj_value_);
                 event.preventDefault()
                 event.stopPropagation()
                 return false
              });
              //
              jqry('#_deviceUpdated_infoView_div_').on('click', 'button', function(event){
                 var _thisSelected_value_ = jqry('#_deviceUpdated_infoView_select_ > option:selected')[0].value;
                 console.log(_thisSelected_value_);
                 var _thisObj_value_ = jqry(this).val();
                 var _thisObj_array_ = _thisObj_value_.split('#');
                 jqry.ajax({
                    type:"PUT",
                    data:JSON.stringify({ 
                      items:[{
                          hostname:_thisObj_array_[0],
                          from_zone:_thisObj_array_[1],
                          to_zone:_thisObj_array_[2],
                          zoneValidation:_thisObj_array_[3],
                          zoneValidationChange:_thisObj_array_[4]
                      }],
                      auth_key:jqry('#_auth_password_').val()
                    }),
                    url:ajax_api_server.concat('juniper/devicelist/'),
                    success:function(data){
                        _callAjax_zoneList_(_thisSelected_value_);                   
                    }
                 });
                 event.preventDefault()
                 event.stopPropagation()
                 return false
              });

              jqry('#_devicesInfoUpdate_subMenu_div_').on('click', '#_devicesInfoUpdate_subMenu_button_', function(event){
                 jqry('#_ajax_return_result_div_').remove();
                 jqry('#_deviceUpdated_infoView_table_').remove();
                 jqry.ajax({
                    type:"POST",
                    url:ajax_api_server.concat('juniper/devicelist/'),
                    data:JSON.stringify({
                        auth_key:jqry('#_auth_password_').val()
                    }),
                    success:function(data){
                        _ajaxSuccess_multiLine_printing_(data, '_ajax_return_result_div_');
                        _deviceUpdated_infoView_(_deviceUpdated_infoView_div_);
                    }
                 });     
                 event.preventDefault()
                 event.stopPropagation()
                 return false
              });
              var _devicesInfoUpdate_subMenu_button_ = jqry('<button>').attr('id','_devicesInfoUpdate_subMenu_button_').html('registered devices information updates').css('color','green').css('font-size','12');
              _devicesInfoUpdate_subMenu_div_.append(_devicesInfoUpdate_subMenu_button_);
              _deviceUpdated_infoView_(_deviceUpdated_infoView_div_);
         }; 
         remove_divAll();
         _login_auth_start_(_devicesInfoUpdate_);
         event.preventDefault()
         event.stopPropagation()
         return false
      });

    });
    



  </script>
 </head>

 <body>
 </body>

</html>
